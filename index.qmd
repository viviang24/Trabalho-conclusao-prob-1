---
title: "Análise Probabilística da Eficiência de Métodos de Captura de Collembola"
author: 
  - "Vivian Germano da Silva"
  - "Aila Soares Ferreira"
format: 
  html:
    toc: true
    toc-title: "Sumário"
    toc-depth: 3
    code-fold: true
    lang: "pt-BR"
jupyter: python3
---

<center>
*Universidade Federal da Paraíba*  
*Disciplina: Probabilidade I*  

*1 de outubro de 2025*
</center>

# Introdução

Este trabalho compara a eficiência de três métodos de amostragem de colêmbolos — **Pitfall**, **Aspirador** e **Winkler** — com base em evidências empíricas obtidas em coletas realizadas em fragmentos de Mata Atlântica na Paraíba. Aplicamos conceitos elementares de probabilidade condicional e Simulação Monte Carlo para avaliar a afinidade de espécies pelos métodos e, assim, indicar o método mais provável pelas capturas observadas.  

**O objetivo deste estudo** é demonstrar, de forma prática, como conceitos de Probabilidade podem ser aplicados à **Ecologia e Conservação da fauna de solo (Collembola)**, avaliando a afinidade de espécies por diferentes métodos de captura e comparando a eficiência relativa das técnicas.  

<br>

As fórmulas fundamentais utilizadas são:  

### Probabilidade condicional (verossimilhança)

$$
P(E \mid H) = \frac{\text{número de indivíduos da espécie }E \text{ capturados pelo método }H}{\text{total de indivíduos coletados pelo método }H}
$$  
  
# Probabilidade de Captura por Método

## Probabilidades com base na riqueza de espécies (presença/ausência)

Totais por método (número de espécies/riqueza) foram:  

- Pitfall: 38  
- Aspirador: 24  
- Winkler: 21  
- Total de espécies: 43  

Assim, as probabilidades de uma espécie ser capturada por cada método (baseado na riqueza) são:  

$$
P(\text{Pitfall}) = \frac{38}{43} \approx 0.8837 \Rightarrow 88,4\%
$$  

$$
P(\text{Aspirador}) = \frac{24}{43} \approx 0.5581 \Rightarrow 55,8\%
$$  

$$
P(\text{Winkler}) = \frac{21}{43} \approx 0.4883 \Rightarrow 48,8\%
$$ 
<br>
Antes de aprofundar os cálculos, apresentamos o diagrama de Venn abaixo, que resume graficamente a sobreposição de espécies detectadas entre os três métodos de coleta, evidenciando quais táxons são exclusivos ou compartilhados.  

![Diagrama de Venn](figuras%20de%20prob%20I/graficos/diagramavenn.png)

O diagrama acima ilustra a sobreposição de espécies capturadas pelos três métodos de coleta.
Podemos observar que:

- **13 espécies (30,2%) foram exclusivas do Pitfall**, reforçando sua alta eficiência em capturar a fauna de solo.

- **Apenas 1 espécie (2,3%) foi exclusiva do Aspirador**, indicando baixa representatividade isolada.

- **2 espécies (4,7%) foram exclusivas do Winkler**, o que mostra que ele ainda tem importância para espécies associadas à serapilheira.

- A interseção tripla (13 espécies; 30,2%) mostra que **cerca de um terço das espécies foram detectadas por todos os métodos**, o que evidencia complementaridade entre as técnicas.

Esse resultado demonstra que, embora o Pitfall seja o método mais eficiente isoladamente, a combinação dos três métodos maximiza a detecção da biodiversidade total.
<br>

## Probabilidades a priori $P(H)$ (proporção de indivíduos)

Os totais por método (soma de todos os indivíduos) foram:  

- Pitfall: 13.469  
- Aspirador: 953  
- Winkler: 314  
- Total geral: 14.736 

Assim, as **probabilidades a priori** $P(H)$ dos métodos são:  

$$
P(\text{Pitfall}) = \frac{13469}{14736} \approx 0.9142 \Rightarrow 91,4\%
$$  

$$
P(\text{Aspirador}) = \frac{953}{14736} \approx 0.0647 \Rightarrow 6,5\%
$$  

$$
P(\text{Winkler}) = \frac{314}{14736} \approx 0.0213 \Rightarrow 2,1\%
$$  

# Espécies mais abundantes

A seguir apresentamos as dez espécies com maior abundância, conforme planilha de campo:  

| Espécie | Pitfall | Aspirador | Winkler | Total Geral |
|---------|---------|-----------|---------|-------------|
| *Lepidocyrtus* sp.n.5 | 4562 | 20 | 2 | 4584 |
| *Lepidocyrtus* sp.n.4 | 4062 | 21 | 14 | 4097 |
| *Lepidocyrtinus paraibensis* | 2312 | 522 | 54 | 2888 |
| *Trogolaphysa formosensis* | 867 | 34 | 3 | 904 |
| *Sphaeridia* sp.1 | 211 | 0 | 101 | 312 |
| *Lepidocyrtinus harena* | 257 | 36 | 2 | 295 |
| *Salina brasiliana* | 180 | 75 | 0 | 255 |
| *Calvatomina* sp.1 | 189 | 15 | 31 | 235 |
| *Rhynchocyrtus* sp.n.1 | 164 | 33 | 3 | 200 |
| *Brachystomella agrosa* | 166 | 2 | 9 | 177 |

Selecionamos três espécies representativas:  

1. *Lepidocyrtus* sp.n.5 – espécie mais abundante (34,6% do total).  
2. *Lepidocyrtinus paraibensis* – táxon com distribuição balanceada entre métodos.  
3. *Rhynchocyrtus* sp.n.1 – táxon relevante para conservação.  

# Cálculo das probabilidades condicionais $P(E\mid H)$

Lembrete:  

$$
P(E\mid H) = \frac{N_{E \ \text{no método}}}{N_{\text{método}}}
$$  

<br>

## 1) *Lepidocyrtus* sp.n.5 (Total = 4.584)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 4562 | 4562/13469 ≈ 0.3387 → **33,9%** | 
| Aspirador | 20 | 20/953 ≈ 0.0210 → **2,1%** |
| Winkler | 2 | 2/314 ≈ 0.00064 → **0,06%** |

<br>

![Distribuição simulada de capturas de Lepidocyrtus sp.n.5 por método](figuras%20de%20prob%20I/graficos/condicional_lepidocyrtus.png)

```python
# Lepidocyrtus sp.n.5
import numpy as np
import matplotlib.pyplot as plt
metodos = ['Pitfall', 'Aspirador', 'Winkler']
totais = [13469, 953, 314]
especie = [4562, 20, 2]
prob = [4562/13469, 20/953, 2/314]
n_sim = 10000
cores_mata_hist = ['mediumseagreen', 'burlywood', 'olivedrab']
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Lepidocyrtus sp.n.5 por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_lepidocyrtus.png')
plt.close()
```

## 2) *Lepidocyrtinus paraibensis* (Total = 2.888)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 2312 | 2312/13469 ≈ 0.1716 → **17,2%** |
| Aspirador | 522 | 522/953 ≈ 0.5477 → **54,8%** |
| Winkler | 54 | 54/314 ≈ 0.1720 → **17,2%** |

<br>

![Distribuição simulada de capturas de Lepidocyrtinus paraibensis por método](figuras%20de%20prob%20I/graficos/condicional_paraibensis.png)

```python
# Lepidocyrtinus paraibensis
especie = [2312, 522, 54]
prob = [2312/13469, 522/953, 54/314]
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Lepidocyrtinus paraibensis por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_paraibensis.png')
plt.close()
```

## 3) *Rhynchocyrtus* sp.n.1 (Total = 200)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 164 | 164/13469 ≈ 0.0122 → **1,22%** |
| Aspirador | 33 | 33/953 ≈ 0.0346 → **3,46%** |
| Winkler | 3 | 3/314 ≈ 0.0096 → **0,96%** |

<br>

![Distribuição simulada de capturas de Rhynchocyrtus sp.n.1 por método](figuras%20de%20prob%20I/graficos/condicional_rhynchocyrtus.png)

```python
# Rhynchocyrtus sp.n.1
especie = [164, 33, 3]
prob = [164/13469, 33/953, 3/314]
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Rhynchocyrtus sp.n.1 por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_rhynchocyrtus.png')
plt.close()
```  

## Simulação Monte Carlo para planejamento amostral

A seguir, uma simulação para estimar quantas espécies podem ser detectadas pelo método Pitfall, considerando a probabilidade observada:

<br>

![Distribuição simulada de espécies detectadas pelo Pitfall (Monte Carlo)](figuras%20de%20prob%20I/graficos/montecarlo_scatter.png)

```python
n_especies = 43
prob_pitfall = 0.8837
n_sim = 10000
amostras = np.random.binomial(n_especies, prob_pitfall, n_sim)
valores, contagem = np.unique(amostras, return_counts=True)
plt.figure(figsize=(8,4))
scatter = plt.scatter(valores, contagem, c=contagem, cmap='YlGn', s=80, edgecolor='black')
plt.colorbar(scatter, label='Frequência')
plt.title('Distribuição simulada de espécies detectadas pelo Pitfall (Monte Carlo)')
plt.xlabel('Número de espécies detectadas')
plt.ylabel('Frequência')
plt.grid(True, linestyle='--', alpha=0.5)
plt.tight_layout()
plt.savefig('graficos/montecarlo_scatter.png')
plt.close()
```

O gráfico de simulação Monte Carlo (10.000 repetições) é uma ferramenta essencial para o planejamento amostral, pois utiliza a probabilidade empírica de 88% de detecção de espécies pelo Pitfall.

- Validação Empírica: O ponto de maior frequência (o mais escuro e alto) está concentrado entre 38 e 39 espécies detectadas. **Isso valida a observação original da tese (38 espécies) como o resultado mais provável em coletas futuras.**

- Variabilidade Esperada: A maioria dos resultados simulados (a área mais densa da distribuição) concentra-se firmemente entre 36 e 41 espécies.

- Baixo Risco de Falha: A probabilidade de o Pitfall falhar e detectar um número muito baixo de espécies (ex: menos de 34) é extremamente baixa, reforçando a confiabilidade do método.

---
# Conclusão

Este estudo demonstrou, **com base em dados empíricos e probabilísticos, que o método Pitfall é o mais eficiente para a captura de colêmbolos**, tanto em abundância (91% dos indivíduos) quanto em riqueza (88% das espécies).

As simulações de Probabilidade Condicional permitiram observar a afinidade de espécies por métodos específicos, enquanto a simulação Monte Carlo forneceu um panorama probabilístico do número esperado de espécies detectadas. 

A importância crucial destes testes está em substituir suposições por dados probabilísticos, permitindo: 

- **Otimização de recursos** humanos e financeiros 
- **Maximização da detecção** de espécies 
- **Planejamento amostral.**
