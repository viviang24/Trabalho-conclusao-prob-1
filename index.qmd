---
title: "Análise Probabilística da Eficiência de Métodos de Captura de Collembola"
author: 
  - "Vivian Germano da Silva"
  - "Aila Soares Ferreira"
format: 
  html:
    toc: true
    toc-title: "Sumário"
    toc-depth: 3
    code-fold: true
    lang: "pt-BR"
jupyter: python3
---

<center>
*Universidade Federal da Paraíba*  
*Disciplina: Probabilidade I*  

*1 de outubro de 2025*
</center>

# Introdução

Este trabalho compara a eficiência de três métodos de amostragem de colêmbolos — **Pitfall**, **Aspirador** e **Winkler** — com base em evidências empíricas obtidas em coletas realizadas em fragmentos de Mata Atlântica na Paraíba. Aplicamos conceitos elementares de probabilidade condicional e o Teorema de Bayes para avaliar a afinidade de espécies pelos métodos e, assim, indicar o método mais provável pelas capturas observadas.  

**O objetivo deste estudo** é demonstrar, de forma prática, como conceitos de Probabilidade podem ser aplicados à **Ecologia e Conservação da fauna de solo (Collembola)**, avaliando a afinidade de espécies por diferentes métodos de captura e comparando a eficiência relativa das técnicas.  

<br>

![Diagrama venn ](figuras%20de%20prob%20I/graficos/diagrama.png)

<br>
As fórmulas fundamentais utilizadas são:  

### Probabilidade condicional (verossimilhança)

$$
P(E \mid H) = \frac{\text{número de indivíduos da espécie }E \text{ capturados pelo método }H}{\text{total de indivíduos coletados pelo método }H}
$$  

### Teorema de Bayes (posterior do método dado a ocorrência da espécie)

$$
P(H \mid E) = \frac{P(E \mid H)\,P(H)}{\sum_{j} P(E \mid H_j)\,P(H_j)}
$$  

onde $P(H)$ é a probabilidade a priori do método $H$ (proporção dos indivíduos totais coletados por esse método).  

# Probabilidade de Captura por Método

## Probabilidades com base na riqueza de espécies (presença/ausência)

Totais por método (número de espécies/riqueza) foram:  

- Pitfall: 38  
- Aspirador: 16  
- Winkler: 20  
- Total de espécies: 43  

Assim, as probabilidades de uma espécie ser capturada por cada método (baseado na riqueza) são:  

$$
P(\text{Pitfall}) = \frac{38}{43} \approx 0.8837
$$  

$$
P(\text{Aspirador}) = \frac{16}{43} \approx 0.3721
$$  

$$
P(\text{Winkler}) = \frac{20}{43} \approx 0.4651
$$  

## Probabilidades a priori $P(H)$ (proporção de indivíduos)

Os totais por método (soma de todos os indivíduos) foram:  

- Pitfall: 13.469  
- Aspirador: 953  
- Winkler: 314  
- Total geral: 14.736  

Assim, as **probabilidades a priori** $P(H)$ dos métodos são:  

$$
P(\text{Pitfall}) = \frac{13469}{14736} \approx 0.9142
$$  

$$
P(\text{Aspirador}) = \frac{953}{14736} \approx 0.0647
$$  

$$
P(\text{Winkler}) = \frac{314}{14736} \approx 0.0213
$$  

# Espécies mais abundantes

A seguir apresentamos as dez espécies com maior abundância, conforme planilha de campo:  

| Espécie | Pitfall | Aspirador | Winkler | Total Geral |
|---------|---------|-----------|---------|-------------|
| *Lepidocyrtus* sp.n.5 | 4562 | 20 | 2 | 4584 |
| *Lepidocyrtus* sp.n.4 | 4062 | 21 | 14 | 4097 |
| *Lepidocyrtinus paraibensis* | 2312 | 522 | 54 | 2888 |
| *Trogolaphysa formosensis* | 867 | 34 | 3 | 904 |
| *Sphaeridia* sp.1 | 211 | 0 | 101 | 312 |
| *Lepidocyrtinus harena* | 257 | 36 | 2 | 295 |
| *Salina brasiliana* | 180 | 75 | 0 | 255 |
| *Calvatomina* sp.1 | 189 | 15 | 31 | 235 |
| *Rhynchocyrtus* sp.n.1 | 164 | 33 | 3 | 200 |
| *Brachystomella agrosa* | 166 | 2 | 9 | 177 |

Selecionamos três espécies representativas:  

1. *Lepidocyrtus* sp.n.5 – espécie mais abundante (34,6% do total).  
2. *Lepidocyrtinus paraibensis* – táxon com distribuição balanceada entre métodos.  
3. *Rhynchocyrtus* sp.n.1 – táxon relevante para conservação.  

# Cálculo das probabilidades condicionais $P(E\mid H)$

Lembrete:  

$$
P(E\mid H) = \frac{N_{E \ \text{no método}}}{N_{\text{método}}}
$$  

<br>

## 1) *Lepidocyrtus* sp.n.5 (Total = 4.584)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 4562 | 4562/13469 ≈ 0.3387 |
| Aspirador | 20 | 20/953 ≈ 0.0210 |
| Winkler | 2 | 2/314 ≈ 0.00064 |

<br>

![Distribuição simulada de capturas de Lepidocyrtus sp.n.5 por método](figuras%20de%20prob%20I/graficos/condicional_lepidocyrtus.png)

```python
# Lepidocyrtus sp.n.5
import numpy as np
import matplotlib.pyplot as plt
metodos = ['Pitfall', 'Aspirador', 'Winkler']
totais = [13469, 953, 314]
especie = [4562, 20, 2]
prob = [4562/13469, 20/953, 2/314]
n_sim = 10000
cores_mata_hist = ['mediumseagreen', 'burlywood', 'olivedrab']
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Lepidocyrtus sp.n.5 por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_lepidocyrtus.png')
plt.close()
```

## 2) *Lepidocyrtinus paraibensis* (Total = 2.888)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 2312 | 2312/13469 ≈ 0.1716 |
| Aspirador | 522 | 522/953 ≈ 0.5477 |
| Winkler | 54 | 54/314 ≈ 0.1720 |

<br>

![Distribuição simulada de capturas de Lepidocyrtinus paraibensis por método](figuras%20de%20prob%20I/graficos/condicional_paraibensis.png)

```python
# Lepidocyrtinus paraibensis
especie = [2312, 522, 54]
prob = [2312/13469, 522/953, 54/314]
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Lepidocyrtinus paraibensis por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_paraibensis.png')
plt.close()
```

## 3) *Rhynchocyrtus* sp.n.1 (Total = 200)

| Método | $N_E$ | $P(E\mid H)$ |
|--------|-------|--------------|
| Pitfall | 164 | 164/13469 ≈ 0.0122 |
| Aspirador | 33 | 33/953 ≈ 0.0346 |
| Winkler | 3 | 3/314 ≈ 0.0096 |

<br>

![Distribuição simulada de capturas de Rhynchocyrtus sp.n.1 por método](figuras%20de%20prob%20I/graficos/condicional_rhynchocyrtus.png)

```python
# Rhynchocyrtus sp.n.1
especie = [164, 33, 3]
prob = [164/13469, 33/953, 3/314]
simulados = [np.random.binomial(t, p, n_sim) for t, p in zip(totais, prob)]
plt.figure(figsize=(10,3))
for i, m in enumerate(metodos):
    plt.hist(simulados[i], bins=30, alpha=0.7, label=m, color=cores_mata_hist[i])
plt.title('Distribuição simulada de capturas de Rhynchocyrtus sp.n.1 por método')
plt.xlabel('Indivíduos capturados')
plt.ylabel('Frequência')
plt.legend()
plt.tight_layout()
plt.savefig('graficos/condicional_rhynchocyrtus.png')
plt.close()
```

# Aplicação do Teorema de Bayes

Escolhemos *Lepidocyrtinus paraibensis* como exemplo.  

- Numerador (Pitfall): 0.1716 × 0.9142 ≈ 0.1569  
- Numerador (Aspirador): 0.5477 × 0.0647 ≈ 0.0354  
- Numerador (Winkler): 0.1720 × 0.0213 ≈ 0.0037  

Denominador (soma dos numeradores):  

$$
0.1569 + 0.0354 + 0.0037 \approx 0.1960
$$  

Posterior para cada método:  

- $P(\text{Pitfall}\mid E) ≈ 0.80 \ (80\%)$  
- $P(\text{Aspirador}\mid E) ≈ 0.18 \ (18\%)$  
- $P(\text{Winkler}\mid E) ≈ 0.02 \ (2\%)$  

## Cálculo Bayesiano em Python

```python
P_E_H = [0.1716, 0.5477, 0.1720]
P_H = [0.9142, 0.0647, 0.0213]
metodos = ['Pitfall', 'Aspirador', 'Winkler']
numeradores = [a*b for a,b in zip(P_E_H, P_H)]
denominador = sum(numeradores)
P_H_E = [n/denominador for n in numeradores]
for m, p in zip(metodos, P_H_E):
    print(f'P({m}|E) = {p:.2%}')
```

# Conclusão

A integração entre probabilidade condicional e Teorema de Bayes permite avaliar de forma mais completa a eficiência dos métodos de captura.  

No caso de *Lepidocyrtinus paraibensis*, o método **Pitfall** apresentou a maior probabilidade posterior de captura (~85%).  

Apesar de o método Winkler ter exibido proporção relativa alta da espécie, sua baixa representatividade reduziu sua influência na análise final. Assim, o método Pitfall se destaca como o mais eficiente, considerando tanto a abundância absoluta quanto a análise probabilística.  

## Simulação Monte Carlo para planejamento amostral

A seguir, uma simulação para estimar quantas espécies podem ser detectadas pelo método Pitfall, considerando a probabilidade observada:

<br>

![Distribuição simulada de espécies detectadas pelo Pitfall (Monte Carlo)](figuras%20de%20prob%20I/graficos/montecarlo_scatter.png)

```python
n_especies = 43
prob_pitfall = 0.8837
n_sim = 10000
amostras = np.random.binomial(n_especies, prob_pitfall, n_sim)
valores, contagem = np.unique(amostras, return_counts=True)
plt.figure(figsize=(8,4))
scatter = plt.scatter(valores, contagem, c=contagem, cmap='YlGn', s=80, edgecolor='black')
plt.colorbar(scatter, label='Frequência')
plt.title('Distribuição simulada de espécies detectadas pelo Pitfall (Monte Carlo)')
plt.xlabel('Número de espécies detectadas')
plt.ylabel('Frequência')
plt.grid(True, linestyle='--', alpha=0.5)
plt.tight_layout()
plt.savefig('graficos/montecarlo_scatter.png')
plt.close()
```

Esse gráfico auxilia no planejamento amostral, mostrando a variabilidade esperada na detecção de espécies.

---

Este estudo também demonstra como a análise probabilística fornece bases científicas para a escolha de métodos de coleta de colêmbolos, indo além da observação empírica.  

Através de diferentes abordagens estatísticas, foi possível estabelecer um **guia metodológico preciso**:

- A **análise de riqueza** revelou que o Pitfall detecta 88% das espécies, consolidando-o como método principal para inventários.  
- A **análise de abundância** confirmou sua dominância numérica (91% dos indivíduos), ideal para estudos quantitativos.  
- Já a **análise de afinidade** identificou que espécies específicas como *L. paraibensis* têm maior probabilidade de captura pelo Aspirador (55%), direcionando seu uso para espécies-alvo.  
- Destaca-se também o caso do *Rhynchocyrtus* sp.n.1, espécie rara da Mata Atlântica com registros conhecidos apenas no Rio de Janeiro, que foi eficientemente capturada pelo Aspirador, demonstrando a importância de métodos complementares para táxons de distribuição restrita.  
- Finalmente, o **Teorema de Bayes** validou estatisticamente a superioridade do Pitfall (80% de eficiência).  

A **importância crucial destes testes** está em substituir suposições por dados probabilísticos, permitindo:  

- **Otimização de recursos** humanos e financeiros  
- **Maximização da detecção** de espécies  
- **Planejamento amostral** cientificamente embasado